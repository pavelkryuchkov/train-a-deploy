import{a as Me}from"./chunk-LGNUFN6P.js";import{b as Q,d as de,f as U,g as X,i as Z,j as fe,l as ee,m as Ce,n as te,p as ge,r as xe,s as ve,u as ie}from"./chunk-A73FDB7P.js";import{a as D}from"./chunk-EXM2XI3D.js";import{a as Ee}from"./chunk-PWD6J7HC.js";import{a as be}from"./chunk-FDT3V673.js";import{c as we}from"./chunk-4D7OLZBK.js";import{a as O,b as Se}from"./chunk-NFDW3DZI.js";import{a as P}from"./chunk-4PPTANTY.js";import{d as _e}from"./chunk-NZ5F7AF7.js";import{a as ue,c as he}from"./chunk-YNWXQWJD.js";import"./chunk-QDL5SYJ2.js";import"./chunk-3X4PWRWX.js";import"./chunk-IP76CWZZ.js";import{a as K,b as pe}from"./chunk-Y5E3HJHA.js";import{$ as G,$b as m,Ab as z,Cb as p,Cc as I,Db as J,Fa as N,Fb as $,Gb as j,Hb as a,Ib as s,Jb as E,K as L,Kc as le,Lb as C,Ob as g,Qb as d,Qc as me,a as b,ac as F,b as y,bb as l,bc as B,ca as Y,cb as w,fa as ce,ic as T,ka as W,kc as H,mc as ae,nc as se,ob as u,pa as V,u as A,vb as v,wa as R,xa as _,xb as S,ya as f}from"./chunk-G6VS4OII.js";var k=(()=>{let r=class r{constructor(e,t,o){this.http=e,this.stationsService=t,this.snackbar=o,this.baseSchedule=u(null),this.stations=this.stationsService.stations,this.stationsMap=this.stationsService.stationsMap,this.schedule=I(()=>{let c=this.baseSchedule();return c?y(b({},c),{cities:c.path.map(x=>this.stationsMap()[x]?.city||"")}):null}),this.isLoadingSchedule=u(!1),this.isLoadingStations=u(!1),this.isLoading=I(()=>this.isLoadingSchedule()||this.isLoadingStations()),this.loadStations()}getSchedule(e){return this.http.get(`/api/route/${e}`).pipe(L(t=>{if(t.error.reason===_e.rideNotFound)return A(null);throw t}))}loadSchedule(e){this.isLoadingSchedule.set(!0),this.getSchedule(e).subscribe(t=>{this.baseSchedule.set(t),this.isLoadingSchedule.set(!1)})}loadStations(){this.isLoadingStations.set(!0),this.http.get("/api/station").subscribe(e=>{this.stations.set(e),this.isLoadingStations.set(!1)})}changePrices(e,t,o){let c=this.baseSchedule();if(!c)throw new Error("Shedule not found");let x=c.id,M=c.schedule.find(h=>h.rideId===e);if(!M)throw new Error("Ride not found");let oe=M.segments.map((h,q)=>q===t?y(b({},h),{price:o}):h);return this.http.put(`/api/route/${x}/ride/${e}`,{segments:oe}).pipe(G(()=>this.getSchedule(x)),Y(h=>this.baseSchedule.set(h)))}changeTime(e,t,o){let c=this.baseSchedule();if(!c)throw new Error("Shedule not found");let x=c.id,M=c.schedule.find(h=>h.rideId===e);if(!M)throw new Error("Ride not found");let oe=M.segments.map((h,q)=>q===t-1&&o.arrival!==void 0?y(b({},h),{time:[h.time[0],o.arrival]}):q===t&&o.departure!==void 0?y(b({},h),{time:[o.departure,h.time[1]]}):h);return this.http.put(`/api/route/${x}/ride/${e}`,{segments:oe}).pipe(G(()=>this.getSchedule(x)),Y(h=>this.baseSchedule.set(h)),L(h=>(this.snackbar.open(h.error.message,"close",{duration:2e3}),A(h))))}createRide(e){let t=this.baseSchedule();if(!t)throw new Error("Shedule not found");let o=t.id;return this.http.post(`/api/route/${o}/ride`,{segments:e}).pipe(G(()=>this.getSchedule(o)),Y(c=>this.baseSchedule.set(c)),L(c=>(this.snackbar.open(c.error.message,"close",{duration:2e3}),A(c))))}deleteRide(e){let t=this.baseSchedule();if(!t)throw new Error("Shedule not found");let o=t.id;return this.http.delete(`/api/route/${o}/ride/${e}`).pipe(L(c=>(this.snackbar.open(c.error.message,"close",{duration:2e3}),A({error:c}))),G(()=>this.getSchedule(o)),Y(c=>this.baseSchedule.set(c)))}};r.\u0275fac=function(t){return new(t||r)(W(pe),W(Ee),W(be))},r.\u0275prov=ce({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var De=i=>({"input-error":i});function Oe(i,r){if(i&1&&E(0,"input",8),i&2){let n=d().$index,e=d();z(H(3,De,e.showErrors()&&e.pricesFormArray.controls[n].invalid)),S("formControlName",n)}}function ke(i,r){if(i&1&&(a(0,"span",7),m(1),s()),i&2){let n=d().$implicit;l(),B("$",n[1],"")}}function Fe(i,r){if(i&1&&(a(0,"p",3)(1,"span",4)(2,"span",5),m(3),s(),m(4,"\xA0\u2014\xA0 "),s(),v(5,Oe,1,5,"input",6)(6,ke,2,1,"span",7),s()),i&2){let n=r.$implicit,e=d();l(3),F(n[0]),l(2),p(e.isEditing()||e.createMode?5:6)}}function Re(i,r){i&1&&(a(0,"button",9),E(1,"mat-spinner",11),s()),i&2&&S("disabled",!0)}function Ne(i,r){if(i&1){let n=C();a(0,"button",12),g("click",function(){_(n);let t=d(2);return f(t.onSave())}),a(1,"mat-icon",13),m(2,"save"),s()()}}function $e(i,r){if(i&1){let n=C();a(0,"button",12),g("click",function(){_(n);let t=d(2);return f(t.onEdit())}),a(1,"mat-icon",13),m(2,"edit"),s()()}}function je(i,r){if(i&1&&v(0,Re,2,1,"button",9)(1,Ne,3,0,"button",10)(2,$e,3,0,"button",10),i&2){let n=d();p(n.isSaving()?0:n.isEditing()?1:2)}}var ye=(()=>{let r=class r{constructor(e,t){this.formBuilder=e,this.scheduleService=t,this.pricesChange=new N,this.priceEntries=[],this.isEditing=u(!1),this.isSaving=u(!1),this.showErrors=u(!1),this.form=this.formBuilder.group({prices:this.formBuilder.array([])})}ngOnChanges(e){if("prices"in e){let t=e.prices.currentValue;this.priceEntries=Object.entries(t)}if("showValidationErrors"in e){let t=e.showValidationErrors.currentValue;this.showErrors.set(t)}}ngOnInit(){this.priceEntries.forEach(e=>this.form.controls.prices.push(this.formBuilder.control(e[1],[de.required,de.min(0)]))),this.form.valueChanges.subscribe(e=>{if(this.form.valid&&this.createMode){let t=this.priceEntries.map(([o],c)=>[o,e.prices?.[c]||0]);this.pricesChange.emit({segmentId:this.segmentId,prices:Object.fromEntries(t)})}})}get pricesFormArray(){return this.form.get("prices")}onEdit(){this.isEditing.set(!0)}onSave(){if(this.form.invalid){this.showErrors.set(!0);return}if(!this.rideId)return;let e=this.priceEntries.map((t,o)=>[t[0],this.pricesFormArray.value[o]]);this.isSaving.set(!0),this.scheduleService.changePrices(this.rideId,this.segmentId,Object.fromEntries(e)).subscribe(()=>{this.isEditing.set(!1),this.isSaving.set(!1)})}};r.\u0275fac=function(t){return new(t||r)(w(xe),w(k))},r.\u0275cmp=V({type:r,selectors:[["app-prices"]],inputs:{prices:"prices",segmentId:"segmentId",rideId:"rideId",createMode:"createMode",showValidationErrors:"showValidationErrors"},outputs:{pricesChange:"pricesChange"},standalone:!0,features:[R,T],decls:7,vars:2,consts:[[1,"form",3,"formGroup"],[1,"heading"],["formArrayName","prices"],[1,"price-wrapper"],[1,"carriage"],[1,"carriage__name"],["type","number","min","0",1,"price-input",3,"formControlName","class"],[1,"price"],["type","number","min","0",1,"price-input",3,"formControlName"],["mat-button","",1,"button",3,"disabled"],["mat-button","",1,"button"],["diameter","35",1,"spinner"],["mat-button","",1,"button",3,"click"],["color","primary",1,"icon"]],template:function(t,o){t&1&&(a(0,"form",0)(1,"h6",1),m(2,"Price"),s(),a(3,"div",2),$(4,Fe,7,2,"p",3,J),s()(),v(6,je,3,1)),t&2&&(S("formGroup",o.form),l(4),j(o.priceEntries),l(2),p(o.createMode?-1:6))},dependencies:[ie,Z,Q,fe,U,X,ge,ee,te,Ce,D,P,O],styles:["[_nghost-%COMP%]{display:inline-flex}.form[_ngcontent-%COMP%]{max-width:170px}.heading[_ngcontent-%COMP%], .price[_ngcontent-%COMP%]{margin:0}.price-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;margin-bottom:2px}.carriage[_ngcontent-%COMP%]{display:flex;min-width:100px}.carriage__name[_ngcontent-%COMP%]{max-width:100%;min-width:0;overflow:hidden;text-overflow:ellipsis}.price-input[_ngcontent-%COMP%]{min-width:60px;border:1px solid #c4c6d0;outline-color:#c4c6d0}.price[_ngcontent-%COMP%]{min-width:60px;overflow:hidden;text-overflow:ellipsis}.input-error[_ngcontent-%COMP%]{border-color:#ba1a1a;outline-color:#ba1a1a}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;font-size:24px!important;margin:0!important}@media (max-width: 500px){.button[_ngcontent-%COMP%]{margin-right:-8px}}"],changeDetection:0});let i=r;return i})();var Ie=i=>({"input-error":i});function Be(i,r){if(i&1&&E(0,"input",3),i&2){let n=d(2);z(H(2,Ie,n.showErrors()&&n.form.controls.arrival.invalid))}}function Ae(i,r){if(i&1&&(a(0,"span"),m(1),ae(2,"date"),s()),i&2){let n=d(2);l(),F(se(2,1,n.arrival,"dd/MM/YYYY hh:mm a"))}}function Le(i,r){if(i&1&&(a(0,"p",1)(1,"strong"),m(2,"Arrival: "),s(),v(3,Be,1,4,"input",2)(4,Ae,3,4,"span"),s()),i&2){let n=d();l(3),p(n.isEditing()||n.createMode?3:4)}}function Ge(i,r){if(i&1&&E(0,"input",5),i&2){let n=d(2);z(H(2,Ie,n.showErrors()&&n.form.controls.departure.invalid))}}function Ye(i,r){if(i&1&&(a(0,"span"),m(1),ae(2,"date"),s()),i&2){let n=d(2);l(),F(se(2,1,n.departure,"dd/MM/YYYY hh:mm a"))}}function ze(i,r){if(i&1&&(a(0,"p",1)(1,"strong"),m(2,"Departure: "),s(),v(3,Ge,1,4,"input",4)(4,Ye,3,4,"span"),s()),i&2){let n=d();l(3),p(n.isEditing()||n.createMode?3:4)}}function He(i,r){i&1&&(a(0,"button",6),E(1,"mat-spinner",8),s()),i&2&&S("disabled",!0)}function qe(i,r){if(i&1){let n=C();a(0,"button",9),g("click",function(){_(n);let t=d(2);return f(t.onSave())}),a(1,"mat-icon",10),m(2,"save"),s()()}}function We(i,r){if(i&1){let n=C();a(0,"button",9),g("click",function(){_(n);let t=d(2);return f(t.onEdit())}),a(1,"mat-icon",10),m(2,"edit"),s()()}}function Je(i,r){if(i&1&&v(0,He,2,1,"button",6)(1,qe,3,0,"button",7)(2,We,3,0,"button",7),i&2){let n=d();p(n.isSaving()?0:n.isEditing()?1:2)}}var Ve=(()=>{let r=class r{constructor(e,t){this.formBuilder=e,this.scheduleService=t,this.timeChange=new N,this.isEditing=u(!1),this.isSaving=u(!1),this.showErrors=u(!1),this.form=this.formBuilder.group({arrival:"",departure:""})}ngOnChanges(e){if("arrival"in e){let t=e.arrival.currentValue,o=t!==""?this.formatDate(t):"";this.form.controls.arrival.setValue(o),this.form.controls.arrival.addValidators([this.dateValidator.bind(this)])}if("departure"in e){let t=e.departure.currentValue,o=t!==""?this.formatDate(t):"";this.form.controls.departure.setValue(o),this.form.controls.departure.addValidators([this.dateValidator.bind(this)])}if("showValidationErrors"in e){let t=e.showValidationErrors.currentValue;this.showErrors.set(t)}}ngOnInit(){this.form.valueChanges.subscribe(e=>{if(this.form.valid&&this.createMode){let t=b({},e);t.arrival&&(t.arrival=this.parseInputDate(t.arrival)),t.departure&&(t.departure=this.parseInputDate(t.departure)),this.timeChange.emit({segmentId:this.segmentId,time:t})}})}formatDate(e){return new Date(e).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}inputDateToTimeStamp(e){let[t,o]=e.trim().split(",");if(t){let c=t.trim().split("/");if(c.length<3)return NaN;t=c.reverse().join("-")}return o&&(o=o.trim()),Date.parse(`${t}T${o||"00:00"}`)}isInputDateValid(e){let t=this.inputDateToTimeStamp(e);return!Number.isNaN(t)}parseInputDate(e){if(!this.isInputDateValid(e))return"";let t=this.inputDateToTimeStamp(e);return new Date(t).toISOString()}dateValidator(e){let t=e.value;return this.isInputDateValid(t)?null:{invalidDate:!0}}onEdit(){this.isEditing.set(!0)}onSave(){if(this.form.invalid){this.showErrors.set(!0);return}if(!this.rideId)return;let e={};typeof this.arrival=="string"&&(e.arrival=this.parseInputDate(this.form.controls.arrival.value)),typeof this.departure=="string"&&(e.departure=this.parseInputDate(this.form.controls.departure.value)),this.isSaving.set(!0),this.scheduleService.changeTime(this.rideId,this.segmentId,e).subscribe(t=>{if(this.isEditing.set(!1),this.isSaving.set(!1),t instanceof K){if(typeof this.arrival=="string"){let o=this.arrival!==""?this.formatDate(this.arrival):"";this.form.controls.arrival.setValue(o)}if(typeof this.departure=="string"){let o=this.departure!==""?this.formatDate(this.departure):"";this.form.controls.departure.setValue(o)}}})}};r.\u0275fac=function(t){return new(t||r)(w(ve),w(k))},r.\u0275cmp=V({type:r,selectors:[["app-time"]],inputs:{segmentId:"segmentId",rideId:"rideId",arrival:"arrival",departure:"departure",createMode:"createMode",showValidationErrors:"showValidationErrors"},outputs:{timeChange:"timeChange"},standalone:!0,features:[R,T],decls:4,vars:4,consts:[[3,"formGroup"],[1,"row"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","arrival",1,"input",3,"class"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","arrival",1,"input"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","departure",1,"input",3,"class"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","departure",1,"input"],["mat-button","",3,"disabled"],["mat-button",""],["diameter","35",1,"spinner"],["mat-button","",3,"click"],["color","primary",1,"icon"]],template:function(t,o){t&1&&(a(0,"form",0),v(1,Le,5,1,"p",1)(2,ze,5,1,"p",1),s(),v(3,Je,3,1)),t&2&&(S("formGroup",o.form),l(),p(o.arrival!==void 0?1:-1),l(),p(o.departure!==void 0?2:-1),l(),p(o.createMode?-1:3))},dependencies:[ie,Z,Q,U,X,ee,te,me,D,P,O],styles:["[_nghost-%COMP%]{display:flex;justify-content:space-between}.row[_ngcontent-%COMP%]{margin:0}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;font-size:24px!important;margin:0!important}.input[_ngcontent-%COMP%]{min-width:60px;border:1px solid #c4c6d0;outline-color:#c4c6d0}.input-error[_ngcontent-%COMP%]{border-color:#ba1a1a;outline-color:#ba1a1a}"],changeDetection:0});let i=r;return i})();function Ke(i,r){i&1&&(a(0,"h6",1),m(1,"New Ride"),s())}function Qe(i,r){if(i&1&&(a(0,"h6",1),m(1),s()),i&2){let n=d();l(),B("Ride ",n.ride==null?null:n.ride.rideId,"")}}function Ue(i,r){i&1&&(a(0,"button",2),E(1,"mat-spinner",6),s()),i&2&&S("disabled",!0)}function Xe(i,r){if(i&1){let n=C();a(0,"button",7),g("click",function(){_(n);let t=d();return f(t.onSave())}),a(1,"mat-icon",8),m(2,"save"),s()()}}function Ze(i,r){if(i&1){let n=C();a(0,"button",7),g("click",function(){_(n);let t=d();return f(t.onDelete())}),a(1,"mat-icon",8),m(2,"delete"),s()()}}function et(i,r){if(i&1){let n=C();a(0,"app-time",16),g("timeChange",function(t){_(n);let o=d(2);return f(o.onTimeChange(t))}),s()}if(i&2){let n=d().$index,e=d();S("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("departure",e.ride?e.ride.segments[0].time[0]:"")("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function tt(i,r){if(i&1){let n=C();a(0,"app-time",17),g("timeChange",function(t){_(n);let o=d(2);return f(o.onTimeChange(t))}),s()}if(i&2){let n=d().$index,e=d();S("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("arrival",e.ride?e.ride.segments[n-1].time[1]:"")("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function it(i,r){if(i&1){let n=C();a(0,"app-time",18),g("timeChange",function(t){_(n);let o=d(2);return f(o.onTimeChange(t))}),s()}if(i&2){let n=d().$index,e=d();S("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("arrival",e.ride?e.ride.segments[n-1].time[1]:"")("departure",e.ride?e.ride.segments[n].time[0]:"")("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function nt(i,r){if(i&1){let n=C();a(0,"app-prices",19),g("pricesChange",function(t){_(n);let o=d(2);return f(o.onPricesChange(t))}),s()}if(i&2){let n=d().$index,e=d();S("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("prices",e.ride?e.ride.segments[n].price:e.emptyPrices)("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function rt(i,r){if(i&1&&(a(0,"div",5)(1,"div",9)(2,"strong"),m(3),s()(),a(4,"div",10),v(5,et,1,5,"app-time",11)(6,tt,1,5,"app-time",12)(7,it,1,6,"app-time",13),s(),a(8,"div",14),v(9,nt,1,5,"app-prices",15),s()()),i&2){let n=r.$implicit,e=r.$index,t=r.$count;l(3),F(n),l(2),p(e===0?5:e===t-1?6:7),l(4),p(e!==t-1?9:-1)}}var Te=(()=>{let r=class r{constructor(e,t){this.scheduleService=e,this.dialog=t,this.closeCard=new N,this.isDeletable=u(!1),this.isSaving=u(!1),this.showValidationErrors=u(!1),this.emptyPrices={},this.newCardPrices=u({}),this.newCardTime=u({}),this.isNewCardValid=I(()=>{let o=this.newCardPrices(),c=this.newCardTime();return!(Object.keys(o).length<this.cities.length-1||Object.keys(c).length<this.cities.length-1||!Object.values(c).every(x=>x.arrival&&x.departure))}),this.newCard=I(()=>{if(!this.isNewCardValid())return[];let o=this.newCardPrices(),c=this.newCardTime();return this.cities.slice(0,-1).map((x,M)=>({time:[c[M].departure,c[M].arrival],price:o[M]}))})}ngOnChanges(e){if("ride"in e){let o=e.ride.currentValue.segments[0].time[0];Date.parse(o)>Date.now()&&this.isDeletable.set(!0)}if("carriages"in e){let t=e.carriages.currentValue;this.emptyPrices=Object.fromEntries(t.map(o=>[o,null]))}}onPricesChange(e){this.newCardPrices.update(t=>y(b({},t),{[e.segmentId]:e.prices}))}onTimeChange(e){this.newCardTime.update(t=>{let{segmentId:o}=e,c=b({},t);return e.time.arrival&&(c[o-1]=y(b({},c[o-1]),{arrival:e.time.arrival})),e.time.departure&&(c[o]=y(b({},c[o]),{departure:e.time.departure})),c})}onDelete(){let e=this.ride?.rideId;e&&this.dialog.open(Me,{data:{heading:"Delete ride",content:"Would you like to delete this ride?",onDelete:()=>this.scheduleService.deleteRide(e)},width:"350px",enterAnimationDuration:0,exitAnimationDuration:0})}onSave(){if(!this.isNewCardValid()){this.showValidationErrors.set(!0);return}this.isSaving.set(!0),this.scheduleService.createRide(this.newCard()).subscribe(e=>{this.isSaving.set(!1),e instanceof K||this.closeCard.emit()})}};r.\u0275fac=function(t){return new(t||r)(w(k),w(we))},r.\u0275cmp=V({type:r,selectors:[["app-ride-card"]],inputs:{cities:"cities",carriages:"carriages",ride:"ride",createMode:"createMode"},outputs:{closeCard:"closeCard"},standalone:!0,features:[R,T],decls:9,vars:3,consts:[[1,"header"],[1,"heading"],["mat-button","",3,"disabled"],["mat-button",""],[1,"card-table"],[1,"card-row"],["diameter","35",1,"spinner"],["mat-button","",3,"click"],["color","primary",1,"icon"],[1,"city"],[1,"time"],[3,"rideId","segmentId","departure","createMode","showValidationErrors"],[3,"rideId","segmentId","arrival","createMode","showValidationErrors"],[3,"rideId","segmentId","arrival","departure","createMode","showValidationErrors"],[1,"prices"],[3,"rideId","segmentId","prices","createMode","showValidationErrors"],[3,"timeChange","rideId","segmentId","departure","createMode","showValidationErrors"],[3,"timeChange","rideId","segmentId","arrival","createMode","showValidationErrors"],[3,"timeChange","rideId","segmentId","arrival","departure","createMode","showValidationErrors"],[3,"pricesChange","rideId","segmentId","prices","createMode","showValidationErrors"]],template:function(t,o){t&1&&(a(0,"div",0),v(1,Ke,2,0,"h6",1)(2,Qe,2,1,"h6",1)(3,Ue,2,1,"button",2)(4,Xe,3,0,"button",3)(5,Ze,3,0,"button",3),s(),a(6,"div",4),$(7,rt,10,3,"div",5,J),s()),t&2&&(l(),p(o.createMode?1:2),l(2),p(o.createMode&&o.isSaving()?3:o.createMode?4:-1),l(2),p(o.isDeletable()?5:-1),l(2),j(o.cities))},dependencies:[ye,Ve,D,P,O],styles:['[_nghost-%COMP%]{width:100%;padding-bottom:16px;border:1px solid #c4c6d0;border-radius:12px}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 16px;border-bottom:1px solid #c4c6d0}.heading[_ngcontent-%COMP%]{margin-bottom:0}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;font-size:24px!important;margin:0!important}.card-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 1fr;grid-template-areas:"city time ." "city . prices"}.city[_ngcontent-%COMP%]{grid-area:city;min-width:70px;max-width:150px;background-color:#fdfbff;overflow:hidden;text-overflow:ellipsis}.time[_ngcontent-%COMP%]{grid-area:time}.prices[_ngcontent-%COMP%]{grid-area:prices;justify-self:end;min-width:0}.city[_ngcontent-%COMP%], .time[_ngcontent-%COMP%], .prices[_ngcontent-%COMP%]{padding:16px}@media (max-width: 500px){.city[_ngcontent-%COMP%], .time[_ngcontent-%COMP%], .prices[_ngcontent-%COMP%]{padding:8px}}'],changeDetection:0});let i=r;return i})();var ot=(i,r)=>r.rideId;function at(i,r){i&1&&E(0,"mat-spinner",1)}function st(i,r){i&1&&(a(0,"p"),m(1,"Route not found"),s())}function dt(i,r){if(i&1){let n=C();a(0,"button",10),g("click",function(){_(n);let t=d(2);return f(t.onToggleCreate())}),m(1,"Create Ride"),s()}}function ct(i,r){if(i&1){let n=C();a(0,"button",11),g("click",function(){_(n);let t=d(2);return f(t.onToggleCreate())}),m(1,"Cancel"),s()}}function lt(i,r){if(i&1){let n=C();a(0,"app-ride-card",12),g("closeCard",function(){_(n);let t=d(2);return f(t.onToggleCreate())}),s()}if(i&2){let n=d(2);S("createMode",!0)("cities",n.cities())("carriages",n.carriages())}}function mt(i,r){if(i&1&&E(0,"app-ride-card",9),i&2){let n=r.$implicit,e=d(2);S("ride",n)("cities",e.cities())("carriages",e.carriages())}}function pt(i,r){if(i&1){let n=C();a(0,"div",2)(1,"button",3),g("click",function(){_(n);let t=d();return f(t.onGoBack())}),a(2,"mat-icon",4),m(3,"arrow_back"),s()(),a(4,"h4",5),m(5),s()(),v(6,dt,2,0,"button",6)(7,ct,2,0,"button",7)(8,lt,1,3,"app-ride-card",8),$(9,mt,1,3,"app-ride-card",9,ot)}if(i&2){let n,e=d();l(5),B("Route: ",e.routeId,""),l(),p(e.showCreateCard()?7:6),l(2),p(e.showCreateCard()?8:-1),l(),j((n=e.scheduleService.schedule())==null?null:n.schedule)}}var _i=(()=>{let r=class r{constructor(e,t,o,c){this.scheduleService=e,this.router=t,this.location=o,this.activatedRoute=c,this.routeId=this.activatedRoute.snapshot.params.id,this.fromRoutesPage=this.router.getCurrentNavigation()?.extras.state?.fromRoutesPage,this.cities=I(()=>{let x=this.scheduleService.schedule();return x?x.cities:[]}),this.carriages=I(()=>{let x=this.scheduleService.schedule();return x?Array.from(new Set(x.carriages)):[]}),this.showCreateCard=u(!1)}ngOnInit(){this.scheduleService.loadSchedule(this.routeId)}onGoBack(){this.fromRoutesPage?this.location.back():this.router.navigate([".."],{relativeTo:this.activatedRoute})}onToggleCreate(){this.showCreateCard.update(e=>!e)}};r.\u0275fac=function(t){return new(t||r)(w(k),w(he),w(le),w(ue))},r.\u0275cmp=V({type:r,selectors:[["app-schedule-page"]],standalone:!0,features:[T],decls:4,vars:1,consts:[[1,"wrapper"],[1,"spinner"],[1,"header"],["mat-button","",3,"click"],[1,"icon"],[1,"heading"],["mat-flat-button","",1,"create-button"],["mat-button","",1,"create-button"],[3,"createMode","cities","carriages"],[3,"ride","cities","carriages"],["mat-flat-button","",1,"create-button",3,"click"],["mat-button","",1,"create-button",3,"click"],[3,"closeCard","createMode","cities","carriages"]],template:function(t,o){t&1&&(a(0,"main",0),v(1,at,1,0,"mat-spinner",1)(2,st,2,0,"p")(3,pt,11,3),s()),t&2&&(l(),p(o.scheduleService.isLoading()?1:o.scheduleService.schedule()?o.scheduleService.schedule()?3:-1:2))},dependencies:[Te,D,P,Se,O],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;width:90%;max-width:1300px;margin:20px auto;padding-bottom:24px}.spinner[_ngcontent-%COMP%]{margin:50px}.header[_ngcontent-%COMP%]{display:flex;align-items:center;align-self:flex-start}.heading[_ngcontent-%COMP%]{margin-bottom:0}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;margin:0!important;font-size:24px!important;color:#ccc}.create-button[_ngcontent-%COMP%]{align-self:flex-start}"],changeDetection:0});let i=r;return i})();export{_i as SchedulePageComponent};
