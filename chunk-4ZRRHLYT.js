import{a as K,c as Q,d as Z,g as $}from"./chunk-H3B25AWE.js";import{a as W}from"./chunk-DEIM6JNK.js";import{a as w,b as Y}from"./chunk-QPDJ62PI.js";import{a as q}from"./chunk-MY2BAZRV.js";import{c as R}from"./chunk-M7SACJ72.js";import{a as X,b as J}from"./chunk-YXK652KW.js";import{a as z,b as B}from"./chunk-RHCQY3SH.js";import{b as I,c as F}from"./chunk-ASKUIWVB.js";import{a as G,b as N,g as L,h as D}from"./chunk-2I7N5JGL.js";import{b as E,d as b,f as S,k as O,r as T,t as V,u as y,x as k,y as H,z as U}from"./chunk-KAAQNIV2.js";import"./chunk-KR6GTJZ6.js";import"./chunk-ZH5VAGIC.js";import"./chunk-ICGFHLI7.js";import"./chunk-3QW477QG.js";import{$b as l,Ab as s,Fb as a,Gb as n,Hb as x,Jb as h,Ob as f,Qb as d,ab as m,ac as j,bb as u,gc as M,mb as g,oa as v,tb as p,vb as P,xa as _,ya as C}from"./chunk-BUUJEY2M.js";function ct(t,i){t&1&&(a(0,"mat-error"),l(1,"You must enter a value"),n())}function pt(t,i){t&1&&(a(0,"mat-error"),l(1,"Not a valid password"),n())}function ft(t,i){t&1&&(a(0,"div",8),x(1,"mat-spinner",9),n())}var tt=(()=>{let i=class i{constructor(o,r,c){this.formBuilder=o,this.dialogRef=r,this.profileService=c,this.isLoading=g(!1),this.passwordChange=this.formBuilder.control("",[b.required,W(8)])}onClick(){this.passwordChange.valid&&(this.isLoading.set(!0),this.profileService.updatePassword(this.passwordChange.value).subscribe(()=>{this.isLoading.set(!1),this.dialogRef.close()}))}};i.\u0275fac=function(r){return new(r||i)(u(T),u(K),u(w))},i.\u0275cmp=v({type:i,selectors:[["app-change-password-dialog"]],standalone:!0,features:[M],decls:15,vars:6,consts:[[1,"password-dialog"],[1,"heading"],["appearance","outline",1,"form-field"],[1,"label"],["matInput","","type","password",1,"input",3,"formControl"],[1,"actions"],["mat-button","","mat-dialog-close","",1,"button",3,"disabled"],["mat-flat-button","","cdkFocusInitial","",1,"button",3,"click","disabled"],[1,"loading-backdrop"],["diameter","100"]],template:function(r,c){r&1&&(a(0,"div",0)(1,"h3",1),l(2,"Change password"),n(),a(3,"mat-form-field",2)(4,"mat-label",3),l(5,"New password"),n(),x(6,"input",4),p(7,ct,2,0,"mat-error")(8,pt,2,0,"mat-error"),n(),a(9,"mat-dialog-actions",5)(10,"button",6),l(11,"Close"),n(),a(12,"button",7),f("click",function(){return c.onClick()}),l(13,"Save"),n()(),p(14,ft,2,0,"div",8),n()),r&2&&(m(6),P("formControl",c.passwordChange),m(),s(c.passwordChange.hasError("required")?7:-1),m(),s(c.passwordChange.hasError("minlength")?8:-1),m(2),P("disabled",c.isLoading()),m(2),P("disabled",c.isLoading()),m(2),s(c.isLoading()?14:-1))},dependencies:[k,y,$,Z,B,z,V,E,S,O,D,L,G,N,F,I],styles:["[_nghost-%COMP%]{position:relative}.password-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:40px;background-color:#fff}.heading[_ngcontent-%COMP%]{margin-bottom:30px}.form-field[_ngcontent-%COMP%]{font-size:22px}.actions[_ngcontent-%COMP%]{display:flex;gap:10px;padding-bottom:0}.button[_ngcontent-%COMP%], .label[_ngcontent-%COMP%]{font-size:20px}"],changeDetection:0});let t=i;return t})();function ut(t,i){t&1&&x(0,"mat-spinner",1)}function _t(t,i){t&1&&(a(0,"mat-error"),l(1,"You must enter a value"),n())}function Ct(t,i){if(t&1){let e=h();a(0,"mat-form-field",14),f("submit",function(){_(e);let r=d(2);return C(r.onSaveName())}),x(1,"input",15),p(2,_t,2,0,"mat-error"),n()}if(t&2){let e=d(2);m(),P("formControl",e.nameControl),m(),s(e.nameControl.hasError("required")?2:-1)}}function gt(t,i){if(t&1&&(a(0,"mat-card-title",6),l(1),n()),t&2){let e,o=d(2);m(),j((e=o.userProfile())==null?null:e.name)}}function xt(t,i){t&1&&x(0,"mat-spinner",7)}function ht(t,i){if(t&1){let e=h();a(0,"button",16),f("click",function(){_(e);let r=d(2);return C(r.onSaveName())}),a(1,"mat-icon",17),l(2,"save"),n()()}}function Pt(t,i){if(t&1){let e=h();a(0,"button",18),f("click",function(){_(e);let r=d(2);return C(r.editName())}),a(1,"mat-icon",17),l(2,"edit"),n()()}}function bt(t,i){t&1&&(a(0,"mat-error"),l(1,"You must enter a value"),n())}function vt(t,i){t&1&&(a(0,"mat-error"),l(1,"Not a valid email"),n())}function Mt(t,i){t&1&&(a(0,"mat-error"),l(1,"Email is already used"),n())}function wt(t,i){if(t&1){let e=h();a(0,"mat-form-field",14,0),f("submit",function(){_(e);let r=d(2);return C(r.onSaveEmail())}),x(2,"input",15),p(3,bt,2,0,"mat-error")(4,vt,2,0,"mat-error")(5,Mt,2,0,"mat-error"),n()}if(t&2){let e=d(2);m(2),P("formControl",e.emailControl),m(),s(e.emailControl.hasError("required")?3:-1),m(),s(e.emailControl.hasError("pattern")?4:-1),m(),s(e.emailControl.hasError("userExists")?5:-1)}}function Et(t,i){if(t&1&&(a(0,"mat-card-title",6),l(1),n()),t&2){let e,o=d(2);m(),j((e=o.userProfile())==null?null:e.email)}}function St(t,i){t&1&&x(0,"mat-spinner",7)}function Ot(t,i){if(t&1){let e=h();a(0,"button",16),f("click",function(){_(e);let r=d(2);return C(r.onSaveEmail())}),a(1,"mat-icon",17),l(2,"save"),n()()}}function Tt(t,i){if(t&1){let e=h();a(0,"button",19),f("click",function(){_(e);let r=d(2);return C(r.editEmail())}),a(1,"mat-icon",17),l(2,"edit"),n()()}}function Vt(t,i){if(t&1){let e=h();a(0,"mat-card",2)(1,"h2"),l(2,"Profile"),n(),a(3,"div",3)(4,"div",4)(5,"h4"),l(6,"Name"),n(),p(7,Ct,3,2,"mat-form-field",5)(8,gt,2,1,"mat-card-title",6),n(),p(9,xt,1,0,"mat-spinner",7)(10,ht,3,0,"button",8)(11,Pt,3,0,"button",9),n(),a(12,"div",3)(13,"div",4)(14,"h4"),l(15,"Email"),n(),p(16,wt,6,4,"mat-form-field",5)(17,Et,2,1,"mat-card-title",6),n(),p(18,St,1,0,"mat-spinner",7)(19,Ot,3,0,"button",8)(20,Tt,3,0,"button",10),n(),a(21,"div",11)(22,"button",12),f("click",function(){_(e);let r=d();return C(r.changePassword())}),l(23,"Change\xA0password"),n(),a(24,"button",13),f("click",function(){_(e);let r=d();return C(r.logout())}),l(25,"Logout"),n()()()}if(t&2){let e=d();m(7),s(e.isEditName()?7:8),m(2),s(e.isLoadingName()?9:e.isEditName()?10:11),m(7),s(e.isEditEmail()?16:17),m(2),s(e.isLoadingEmail()?18:e.isEditEmail()?19:20)}}var re=(()=>{let i=class i{constructor(o,r,c,A,et){this.formBuilder=o,this.router=r,this.profileService=c,this.authService=A,this.dialog=et,this.userProfile=g(null),this.isEditName=g(!1),this.isEditEmail=g(!1),this.isLoading=g(!1),this.isLoadingName=g(!1),this.isLoadingEmail=g(!1),this.nameControl=this.formBuilder.control("",[b.required]),this.emailControl=this.formBuilder.control("",[b.required,b.pattern(q)])}ngOnInit(){this.isLoading.set(!0),this.profileService.loadUser().subscribe(o=>{this.userProfile.set(o),this.nameControl.setValue(o.name),this.emailControl.setValue(o.email),this.isLoading.set(!1)})}editName(){this.isEditName.set(!0)}editEmail(){this.isEditEmail.set(!0)}onSaveName(){this.nameControl.valid&&(this.isLoadingName.set(!0),this.profileService.editName(this.nameControl.value).subscribe(o=>{this.userProfile.set(o),this.nameControl.setValue(o.name),this.isLoadingName.set(!1),this.isEditName.set(!1)}))}onSaveEmail(){this.emailControl.valid&&(this.isLoadingEmail.set(!0),this.profileService.editEmail(this.emailControl.value).subscribe(o=>{o.error?this.emailControl.setErrors({userExists:!0}):o.profile&&(this.userProfile.set(o.profile),this.emailControl.setValue(o.profile.email),this.isEditEmail.set(!1)),this.isLoadingEmail.set(!1)}))}changePassword(){this.dialog.open(tt,{width:"550px",enterAnimationDuration:0,exitAnimationDuration:0})}logout(){this.authService.logout().subscribe(()=>{this.router.navigate(["/"])})}};i.\u0275fac=function(r){return new(r||i)(u(T),u(R),u(w),u(Y),u(Q))},i.\u0275cmp=v({type:i,selectors:[["app-profile-page"]],standalone:!0,features:[M],decls:2,vars:1,consts:[["form",""],[1,"spinner"],["appearance","outlined",1,"profile-card"],[1,"wrapper"],[1,"content-wrapper"],["appearance","outline",1,"form-field"],[1,"title"],["diameter","35",1,"saving-spinner"],["type","submit",1,"icon-button"],["type","button",1,"icon-button"],[1,"icon-button"],[1,"buttons-wrapper"],["mat-flat-button","",1,"button",3,"click"],["mat-flat-button","",1,"button","logout-button",3,"click"],["appearance","outline",1,"form-field",3,"submit"],["type","text","matInput","",1,"input",3,"formControl"],["type","submit",1,"icon-button",3,"click"],[1,"icon"],["type","button",1,"icon-button",3,"click"],[1,"icon-button",3,"click"]],template:function(r,c){r&1&&p(0,ut,1,0,"mat-spinner",1)(1,Vt,26,4,"mat-card",2),r&2&&s(c.isLoading()?0:1)},dependencies:[X,J,U,H,k,y,V,E,S,O,B,z,D,L,N,F,I],styles:[".profile-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;align-items:start;max-width:650px;width:90%;margin:40px auto;padding:40px 60px}.profile-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{align-self:center}@media (max-width: 700px){.profile-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:36px}}@media (max-width: 700px){.profile-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:26px}}.wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;border-bottom:solid 1px #eee;padding-bottom:10px}.content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:60%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}@media (max-width: 700px){.title[_ngcontent-%COMP%]{font-size:18px}}.form-field[_ngcontent-%COMP%]{width:100%;font-size:20px}@media (max-width: 700px){.form-field[_ngcontent-%COMP%]{font-size:18px}}.icon-button[_ngcontent-%COMP%]{border:none;background-color:inherit;margin-top:40px;cursor:pointer}.icon[_ngcontent-%COMP%]{width:35px;height:35px;font-size:35px;color:#054be0}@media (max-width: 700px){.icon[_ngcontent-%COMP%]{width:30px;height:30px;font-size:30px}}.saving-spinner[_ngcontent-%COMP%]{margin-top:40px}.buttons-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-self:center;width:80%;margin-top:20px}@media (max-width: 650px){.buttons-wrapper[_ngcontent-%COMP%]{flex-direction:column;gap:10px}}.button[_ngcontent-%COMP%]{font-size:20px;padding:30px}@media (max-width: 650px){.button[_ngcontent-%COMP%]{font-size:16px;padding:20px}}.button.logout-button[_ngcontent-%COMP%]{background-color:#b41414}.spinner[_ngcontent-%COMP%]{margin:80px auto}"],changeDetection:0});let t=i;return t})();export{re as ProfilePageComponent};
