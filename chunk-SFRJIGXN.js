import{a as X,b as J,f as z,g as B,k as K,m as Q,n as Z,q as $}from"./chunk-AIJ7BFN6.js";import{a as I,b as F,c as W}from"./chunk-YPRHJOHJ.js";import{A as U,a as E,b,d as S,h as T,l as O,m as V,n as y,q as N,r as G,s as k,x as D,y as L,z as H}from"./chunk-GR4BLG6T.js";import{a as q,d as M,e as Y}from"./chunk-R7BTQV4R.js";import"./chunk-5WFXU4CF.js";import"./chunk-ZLRDRSCN.js";import{o as R}from"./chunk-NKAKMUPO.js";import{Ab as a,Bb as n,Cb as x,Eb as h,Gb as f,Hb as c,Sb as l,Tb as j,Wb as w,Xa as m,Ya as u,hb as g,ka as v,ob as p,qb as P,sa as _,ta as C,vb as s}from"./chunk-SQV3AFQF.js";function ct(t,i){t&1&&(a(0,"mat-error"),l(1,"You must enter a value"),n())}function pt(t,i){t&1&&(a(0,"mat-error"),l(1,"Not a valid password"),n())}function ft(t,i){}function ut(t,i){t&1&&(a(0,"div",8),x(1,"mat-spinner",9),n())}var tt=(()=>{let i=class i{constructor(o,r,d){this.formBuilder=o,this.dialogRef=r,this.profileService=d,this.isLoading=g(!1),this.passwosdChange=this.formBuilder.control("",[b.required,W(8)])}onChange(){this.passwosdChange.valid&&(this.isLoading.set(!0),this.profileService.updatePassword(this.passwosdChange.value).subscribe(()=>{this.isLoading.set(!1),this.dialogRef.close()}))}};i.\u0275fac=function(r){return new(r||i)(u(O),u(K),u(M))},i.\u0275cmp=v({type:i,selectors:[["app-change-password-dialog"]],standalone:!0,features:[w],decls:16,vars:7,consts:[[1,"password-dialog"],[1,"heading"],["appearance","outline",1,"form-field"],[1,"label"],["matInput","","type","password",1,"input",3,"formControl"],[1,"actions"],["mat-button","","mat-dialog-close","",1,"button",3,"disabled"],["mat-flat-button","","cdkFocusInitial","",1,"button",3,"click","disabled"],[1,"loading-backdrop"],["diameter","100"]],template:function(r,d){r&1&&(a(0,"div",0)(1,"h3",1),l(2,"Change password"),n(),a(3,"mat-form-field",2)(4,"mat-label",3),l(5,"New password"),n(),x(6,"input",4),p(7,ct,2,0,"mat-error")(8,pt,2,0,"mat-error")(9,ft,0,0),n(),a(10,"mat-dialog-actions",5)(11,"button",6),l(12,"Close"),n(),a(13,"button",7),f("click",function(){return d.onChange()}),l(14,"Save"),n()(),p(15,ut,2,0,"div",8),n()),r&2&&(m(6),P("formControl",d.passwosdChange),m(),s(d.passwosdChange.hasError("required")?7:-1),m(),s(d.passwosdChange.hasError("minlength")?8:-1),m(),s(d.passwosdChange.invalid?9:-1),m(2),P("disabled",d.isLoading()),m(2),P("disabled",d.isLoading()),m(2),s(d.isLoading()?15:-1))},dependencies:[N,y,$,Z,B,z,V,E,S,T,L,D,G,k,F,I],styles:["[_nghost-%COMP%]{position:relative}.password-dialog[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:40px;background-color:#fff}.heading[_ngcontent-%COMP%]{margin-bottom:30px}.form-field[_ngcontent-%COMP%]{font-size:22px}.actions[_ngcontent-%COMP%]{display:flex;gap:10px;padding-bottom:0}.button[_ngcontent-%COMP%], .label[_ngcontent-%COMP%]{font-size:20px}"],changeDetection:0});let t=i;return t})();function _t(t,i){t&1&&x(0,"mat-spinner",1)}function Ct(t,i){t&1&&(a(0,"mat-error"),l(1,"You must enter a value"),n())}function gt(t,i){if(t&1){let e=h();a(0,"mat-form-field",14),f("submit",function(){_(e);let r=c(2);return C(r.onSaveName())}),x(1,"input",15),p(2,Ct,2,0,"mat-error"),n()}if(t&2){let e=c(2);m(),P("formControl",e.nameControl),m(),s(e.nameControl.hasError("required")?2:-1)}}function xt(t,i){if(t&1&&(a(0,"mat-card-title",6),l(1),n()),t&2){let e,o=c(2);m(),j((e=o.userProfile())==null?null:e.name)}}function ht(t,i){t&1&&x(0,"mat-spinner",7)}function Pt(t,i){if(t&1){let e=h();a(0,"button",16),f("click",function(){_(e);let r=c(2);return C(r.onSaveName())}),a(1,"mat-icon",17),l(2,"save"),n()()}}function bt(t,i){if(t&1){let e=h();a(0,"button",18),f("click",function(){_(e);let r=c(2);return C(r.editName())}),a(1,"mat-icon",17),l(2,"edit"),n()()}}function vt(t,i){t&1&&(a(0,"mat-error"),l(1,"You must enter a value"),n())}function wt(t,i){t&1&&(a(0,"mat-error"),l(1,"Not a valid email"),n())}function Mt(t,i){t&1&&(a(0,"mat-error"),l(1,"Email is already used"),n())}function Et(t,i){if(t&1){let e=h();a(0,"mat-form-field",14,0),f("submit",function(){_(e);let r=c(2);return C(r.onSaveEmail())}),x(2,"input",15),p(3,vt,2,0,"mat-error")(4,wt,2,0,"mat-error")(5,Mt,2,0,"mat-error"),n()}if(t&2){let e=c(2);m(2),P("formControl",e.emailControl),m(),s(e.emailControl.hasError("required")?3:-1),m(),s(e.emailControl.hasError("pattern")?4:-1),m(),s(e.emailControl.hasError("userExists")?5:-1)}}function St(t,i){if(t&1&&(a(0,"mat-card-title",6),l(1),n()),t&2){let e,o=c(2);m(),j((e=o.userProfile())==null?null:e.email)}}function Tt(t,i){t&1&&x(0,"mat-spinner",7)}function Ot(t,i){if(t&1){let e=h();a(0,"button",16),f("click",function(){_(e);let r=c(2);return C(r.onSaveEmail())}),a(1,"mat-icon",17),l(2,"save"),n()()}}function Vt(t,i){if(t&1){let e=h();a(0,"button",19),f("click",function(){_(e);let r=c(2);return C(r.editEmail())}),a(1,"mat-icon",17),l(2,"edit"),n()()}}function yt(t,i){if(t&1){let e=h();a(0,"mat-card",2)(1,"h2"),l(2,"Profile"),n(),a(3,"div",3)(4,"div",4)(5,"h4"),l(6,"Name"),n(),p(7,gt,3,2,"mat-form-field",5)(8,xt,2,1,"mat-card-title",6),n(),p(9,ht,1,0,"mat-spinner",7)(10,Pt,3,0,"button",8)(11,bt,3,0,"button",9),n(),a(12,"div",3)(13,"div",4)(14,"h4"),l(15,"Email"),n(),p(16,Et,6,4,"mat-form-field",5)(17,St,2,1,"mat-card-title",6),n(),p(18,Tt,1,0,"mat-spinner",7)(19,Ot,3,0,"button",8)(20,Vt,3,0,"button",10),n(),a(21,"div",11)(22,"button",12),f("click",function(){_(e);let r=c();return C(r.changePassword())}),l(23,"Change\xA0password"),n(),a(24,"button",13),f("click",function(){_(e);let r=c();return C(r.logout())}),l(25,"Logout"),n()()()}if(t&2){let e=c();m(7),s(e.isEditName()?7:8),m(2),s(e.isLoadingName()?9:e.isEditName()?10:11),m(7),s(e.isEditEmail()?16:17),m(2),s(e.isLoadingEmail()?18:e.isEditEmail()?19:20)}}var le=(()=>{let i=class i{constructor(o,r,d,A,et){this.formBuilder=o,this.router=r,this.profileService=d,this.authService=A,this.dialog=et,this.userProfile=g(null),this.isEditName=g(!1),this.isEditEmail=g(!1),this.isLoading=g(!1),this.isLoadingName=g(!1),this.isLoadingEmail=g(!1),this.nameControl=this.formBuilder.control("",[b.required]),this.emailControl=this.formBuilder.control("",[b.required,b.pattern(q)])}ngOnInit(){this.isLoading.set(!0),this.profileService.loadUser().subscribe(o=>{this.userProfile.set(o),this.nameControl.setValue(o.name),this.emailControl.setValue(o.email),this.isLoading.set(!1)})}editName(){this.isEditName.set(!0)}editEmail(){this.isEditEmail.set(!0)}onSaveName(){this.nameControl.valid&&(this.isLoadingName.set(!0),this.profileService.editName(this.nameControl.value).subscribe(o=>{this.userProfile.set(o),this.nameControl.setValue(o.name),this.isLoadingName.set(!1),this.isEditName.set(!1)}))}onSaveEmail(){this.emailControl.valid&&(this.isLoadingEmail.set(!0),this.profileService.editEmail(this.emailControl.value).subscribe(o=>{o.error?this.emailControl.setErrors({userExists:!0}):o.profile&&(this.userProfile.set(o.profile),this.emailControl.setValue(o.profile.email),this.isEditEmail.set(!1)),this.isLoadingEmail.set(!1)}))}changePassword(){this.dialog.open(tt,{width:"550px",enterAnimationDuration:0,exitAnimationDuration:0})}logout(){this.authService.logout().subscribe(()=>{this.router.navigate(["/"])})}};i.\u0275fac=function(r){return new(r||i)(u(O),u(R),u(M),u(Y),u(Q))},i.\u0275cmp=v({type:i,selectors:[["app-profile-page"]],standalone:!0,features:[w],decls:2,vars:1,consts:[["form",""],[1,"spinner"],["appearance","outlined",1,"profile-card"],[1,"wrapper"],[1,"content-wrapper"],["appearance","outline",1,"form-field"],[1,"title"],["diameter","35",1,"saving-spinner"],["type","submit",1,"icon-button"],["type","button",1,"icon-button"],[1,"icon-button"],[1,"buttons-wrapper"],["mat-flat-button","",1,"button",3,"click"],["mat-flat-button","",1,"button","logout-button",3,"click"],["appearance","outline",1,"form-field",3,"submit"],["type","text","matInput","",1,"input",3,"formControl"],["type","submit",1,"icon-button",3,"click"],[1,"icon"],["type","button",1,"icon-button",3,"click"],[1,"icon-button",3,"click"]],template:function(r,d){r&1&&p(0,_t,1,0,"mat-spinner",1)(1,yt,26,4,"mat-card",2),r&2&&s(d.isLoading()?0:1)},dependencies:[X,J,U,H,N,y,V,E,S,T,B,z,L,D,k,F,I],styles:[".profile-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;align-items:start;max-width:650px;width:90%;margin:40px auto;padding:40px 60px}.profile-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{align-self:center}@media (max-width: 700px){.profile-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:36px}}@media (max-width: 700px){.profile-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:26px}}.wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;border-bottom:solid 1px #eee;padding-bottom:10px}.content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:60%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}@media (max-width: 700px){.title[_ngcontent-%COMP%]{font-size:18px}}.form-field[_ngcontent-%COMP%]{width:100%;font-size:20px}@media (max-width: 700px){.form-field[_ngcontent-%COMP%]{font-size:18px}}.icon-button[_ngcontent-%COMP%]{border:none;background-color:inherit;margin-top:40px;cursor:pointer}.icon[_ngcontent-%COMP%]{width:35px;height:35px;font-size:35px;color:#054be0}@media (max-width: 700px){.icon[_ngcontent-%COMP%]{width:30px;height:30px;font-size:30px}}.saving-spinner[_ngcontent-%COMP%]{margin-top:40px}.buttons-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-self:center;width:80%;margin-top:20px}@media (max-width: 650px){.buttons-wrapper[_ngcontent-%COMP%]{flex-direction:column;gap:10px}}.button[_ngcontent-%COMP%]{font-size:20px;padding:30px}@media (max-width: 650px){.button[_ngcontent-%COMP%]{font-size:16px;padding:20px}}.button.logout-button[_ngcontent-%COMP%]{background-color:#b41414}.spinner[_ngcontent-%COMP%]{margin:80px auto}"],changeDetection:0});let t=i;return t})();export{le as ProfilePageComponent};
