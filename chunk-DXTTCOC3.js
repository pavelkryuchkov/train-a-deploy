import{a as we}from"./chunk-UQWQDUAI.js";import{c as Se}from"./chunk-7NDOFM3A.js";import{c as he}from"./chunk-MY2BAZRV.js";import{a as pe,c as ue}from"./chunk-5KWTDDC5.js";import{a as O,b as ve}from"./chunk-BN6COBRA.js";import{a as H,b as re,d as W,e as J,g as K,h as _e,j as Q,k as fe,l as U,n as Ce,o as ge,p as xe,r as X,s as P,w as D}from"./chunk-ILAPDML3.js";import"./chunk-376MERAZ.js";import"./chunk-TUFASTQV.js";import{d as ce,g as le,j as me}from"./chunk-XNQEGZ6G.js";import{$ as A,$b as Y,Ab as j,Ba as N,Bb as a,Cb as s,Db as E,Fb as f,I as ae,Jb as C,Kb as d,Vb as m,Wb as G,Xb as R,Y as B,Ya as l,Za as w,Zb as T,a as b,ac as ie,b as y,bc as ne,ca as se,ha as de,ib as p,ka as V,pb as g,qc as M,rb as v,s as oe,sa as k,ta as h,ua as _,ub as L,wb as u,xb as q,zb as $}from"./chunk-743WUKBY.js";var F=(()=>{let r=class r{constructor(e){this.http=e,this.baseSchedule=p(null),this.stations=p([]),this.stationsMap=M(()=>{let t={};return this.stations().forEach(o=>{t[o.id]=o}),t}),this.schedule=M(()=>{let t=this.baseSchedule();return t?y(b({},t),{cities:t.path.map(o=>this.stationsMap()[o]?.city||"")}):null}),this.isLoadingSchedule=p(!1),this.isLoadingStations=p(!1),this.isLoading=M(()=>this.isLoadingSchedule()||this.isLoadingStations()),this.loadStations()}getSchedule(e){return this.http.get(`/api/route/${e}`).pipe(ae(t=>{if(t.error.reason===he.rideNotFound)return oe(null);throw t}))}loadSchedule(e){this.isLoadingSchedule.set(!0),this.getSchedule(e).subscribe(t=>{this.baseSchedule.set(t),this.isLoadingSchedule.set(!1)})}loadStations(){this.isLoadingStations.set(!0),this.http.get("/api/station").subscribe(e=>{this.stations.set(e),this.isLoadingStations.set(!1)})}changePrices(e,t,o){let c=this.baseSchedule();if(!c)throw new Error("Shedule not found");let S=c.id,I=c.schedule.find(x=>x.rideId===e);if(!I)throw new Error("Ride not found");let te=I.segments.map((x,z)=>z===t?y(b({},x),{price:o}):x);return this.http.put(`/api/route/${S}/ride/${e}`,{segments:te}).pipe(B(()=>this.getSchedule(S)),A(x=>this.baseSchedule.set(x)))}changeTime(e,t,o){let c=this.baseSchedule();if(!c)throw new Error("Shedule not found");let S=c.id,I=c.schedule.find(x=>x.rideId===e);if(!I)throw new Error("Ride not found");let te=I.segments.map((x,z)=>z===t-1&&o.arrival!==void 0?y(b({},x),{time:[x.time[0],o.arrival]}):z===t&&o.departure!==void 0?y(b({},x),{time:[o.departure,x.time[1]]}):x);return this.http.put(`/api/route/${S}/ride/${e}`,{segments:te}).pipe(B(()=>this.getSchedule(S)),A(x=>this.baseSchedule.set(x)))}createRide(e){let t=this.baseSchedule();if(!t)throw new Error("Shedule not found");let o=t.id;return this.http.post(`/api/route/${o}/ride`,{segments:e}).pipe(B(()=>this.getSchedule(o)),A(c=>this.baseSchedule.set(c)))}deleteRide(e){let t=this.baseSchedule();if(!t)throw new Error("Shedule not found");let o=t.id;return this.http.delete(`/api/route/${o}/ride/${e}`).pipe(B(()=>this.getSchedule(o)),A(c=>this.baseSchedule.set(c)))}};r.\u0275fac=function(t){return new(t||r)(de(me))},r.\u0275prov=se({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var Ve=i=>({"input-error":i});function Te(i,r){if(i&1&&E(0,"input",7),i&2){let n=d().$index,e=d();L(Y(3,Ve,e.showErrors()&&e.pricesFormArray.controls[n].invalid)),v("formControlName",n)}}function Pe(i,r){if(i&1&&(a(0,"span",6),m(1),s()),i&2){let n=d().$implicit;l(),R("$",n[1],"")}}function De(i,r){if(i&1&&(a(0,"p",3)(1,"span",4),m(2),s(),g(3,Te,1,5,"input",5)(4,Pe,2,1,"span",6),s()),i&2){let n=r.$implicit,e=d();l(2),R("",n[0],"\xA0\u2014\xA0"),l(),u(e.isEditing()||e.createMode?3:4)}}function Oe(i,r){i&1&&(a(0,"button",8),E(1,"mat-spinner",10),s()),i&2&&v("disabled",!0)}function Fe(i,r){if(i&1){let n=f();a(0,"button",11),C("click",function(){h(n);let t=d(2);return _(t.onSave())}),a(1,"mat-icon",12),m(2,"save"),s()()}}function Re(i,r){if(i&1){let n=f();a(0,"button",11),C("click",function(){h(n);let t=d(2);return _(t.onEdit())}),a(1,"mat-icon",12),m(2,"edit"),s()()}}function ke(i,r){if(i&1&&g(0,Oe,2,1,"button",8)(1,Fe,3,0,"button",9)(2,Re,3,0,"button",9),i&2){let n=d();u(n.isSaving()?0:n.isEditing()?1:2)}}var be=(()=>{let r=class r{constructor(e,t){this.formBuilder=e,this.scheduleService=t,this.pricesChange=new N,this.priceEntries=[],this.isEditing=p(!1),this.isSaving=p(!1),this.showErrors=p(!1),this.form=this.formBuilder.group({prices:this.formBuilder.array([])})}ngOnChanges(e){if("prices"in e){let t=e.prices.currentValue;this.priceEntries=Object.entries(t)}if("showValidationErrors"in e){let t=e.showValidationErrors.currentValue;this.showErrors.set(t)}}ngOnInit(){this.priceEntries.forEach(e=>this.form.controls.prices.push(this.formBuilder.control(e[1],[re.required,re.min(0)]))),this.form.valueChanges.subscribe(e=>{if(this.form.valid&&this.createMode){let t=this.priceEntries.map(([o],c)=>[o,e.prices?.[c]||0]);this.pricesChange.emit({segmentId:this.segmentId,prices:Object.fromEntries(t)})}})}get pricesFormArray(){return this.form.get("prices")}onEdit(){this.isEditing.set(!0)}onSave(){if(this.form.invalid){this.showErrors.set(!0);return}if(!this.rideId)return;let e=this.priceEntries.map((t,o)=>[t[0],this.pricesFormArray.value[o]]);this.isSaving.set(!0),this.scheduleService.changePrices(this.rideId,this.segmentId,Object.fromEntries(e)).subscribe(()=>{this.isEditing.set(!1),this.isSaving.set(!1)})}};r.\u0275fac=function(t){return new(t||r)(w(ge),w(F))},r.\u0275cmp=V({type:r,selectors:[["app-prices"]],inputs:{prices:"prices",segmentId:"segmentId",rideId:"rideId",createMode:"createMode",showValidationErrors:"showValidationErrors"},outputs:{pricesChange:"pricesChange"},standalone:!0,features:[k,T],decls:7,vars:2,consts:[[1,"form",3,"formGroup"],[1,"heading"],["formArrayName","prices"],[1,"price-wrapper"],[1,"carriage"],["type","number","min","0",1,"price-input",3,"formControlName","class"],[1,"price"],["type","number","min","0",1,"price-input",3,"formControlName"],["mat-button","",3,"disabled"],["mat-button",""],["diameter","35",1,"spinner"],["mat-button","",3,"click"],["color","primary",1,"icon"]],template:function(t,o){t&1&&(a(0,"form",0)(1,"h6",1),m(2,"Price"),s(),a(3,"div",2),$(4,De,5,2,"p",3,q),s()(),g(6,ke,3,1)),t&2&&(v("formGroup",o.form),l(4),j(o.priceEntries),l(2),u(o.createMode?-1:6))},dependencies:[X,K,H,_e,W,J,Ce,Q,U,fe,D,P,O],styles:["[_nghost-%COMP%]{display:inline-flex}.form[_ngcontent-%COMP%]{max-width:170px}.heading[_ngcontent-%COMP%], .price[_ngcontent-%COMP%]{margin:0}.price-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;margin-bottom:2px}.price-input[_ngcontent-%COMP%]{min-width:60px;border:1px solid #c4c6d0;outline-color:#c4c6d0}.input-error[_ngcontent-%COMP%]{border-color:#ba1a1a;outline-color:#ba1a1a}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;font-size:24px!important;margin:0!important}"],changeDetection:0});let i=r;return i})();var Ee=i=>({"input-error":i});function Ne(i,r){if(i&1&&E(0,"input",3),i&2){let n=d(2);L(Y(2,Ee,n.showErrors()&&n.form.controls.arrival.invalid))}}function $e(i,r){if(i&1&&(a(0,"span"),m(1),ie(2,"date"),s()),i&2){let n=d(2);l(),G(ne(2,1,n.arrival,"dd/MM/YYYY hh:mm a"))}}function je(i,r){if(i&1&&(a(0,"p",1)(1,"strong"),m(2,"Arrival: "),s(),g(3,Ne,1,4,"input",2)(4,$e,3,4,"span"),s()),i&2){let n=d();l(3),u(n.isEditing()||n.createMode?3:4)}}function Be(i,r){if(i&1&&E(0,"input",5),i&2){let n=d(2);L(Y(2,Ee,n.showErrors()&&n.form.controls.departure.invalid))}}function Ae(i,r){if(i&1&&(a(0,"span"),m(1),ie(2,"date"),s()),i&2){let n=d(2);l(),G(ne(2,1,n.departure,"dd/MM/YYYY hh:mm a"))}}function Le(i,r){if(i&1&&(a(0,"p",1)(1,"strong"),m(2,"Departure: "),s(),g(3,Be,1,4,"input",4)(4,Ae,3,4,"span"),s()),i&2){let n=d();l(3),u(n.isEditing()||n.createMode?3:4)}}function Ge(i,r){i&1&&(a(0,"button",6),E(1,"mat-spinner",8),s()),i&2&&v("disabled",!0)}function Ye(i,r){if(i&1){let n=f();a(0,"button",9),C("click",function(){h(n);let t=d(2);return _(t.onSave())}),a(1,"mat-icon",10),m(2,"save"),s()()}}function ze(i,r){if(i&1){let n=f();a(0,"button",9),C("click",function(){h(n);let t=d(2);return _(t.onEdit())}),a(1,"mat-icon",10),m(2,"edit"),s()()}}function qe(i,r){if(i&1&&g(0,Ge,2,1,"button",6)(1,Ye,3,0,"button",7)(2,ze,3,0,"button",7),i&2){let n=d();u(n.isSaving()?0:n.isEditing()?1:2)}}var Ie=(()=>{let r=class r{constructor(e,t){this.formBuilder=e,this.scheduleService=t,this.timeChange=new N,this.isEditing=p(!1),this.isSaving=p(!1),this.showErrors=p(!1),this.form=this.formBuilder.group({arrival:"",departure:""})}ngOnChanges(e){if("arrival"in e){let t=e.arrival.currentValue,o=t!==""?this.formatDate(t):"";this.form.controls.arrival.setValue(o),this.form.controls.arrival.addValidators([this.dateValidator.bind(this)])}if("departure"in e){let t=e.departure.currentValue,o=t!==""?this.formatDate(t):"";this.form.controls.departure.setValue(o),this.form.controls.departure.addValidators([this.dateValidator.bind(this)])}if("showValidationErrors"in e){let t=e.showValidationErrors.currentValue;this.showErrors.set(t)}}ngOnInit(){this.form.valueChanges.subscribe(e=>{if(this.form.valid&&this.createMode){let t=b({},e);t.arrival&&(t.arrival=this.parseInputDate(t.arrival)),t.departure&&(t.departure=this.parseInputDate(t.departure)),this.timeChange.emit({segmentId:this.segmentId,time:t})}})}formatDate(e){return new Date(e).toLocaleString("en-GB",{dateStyle:"short",timeStyle:"short"})}inputDateToTimeStamp(e){let[t,o]=e.trim().split(",");if(t){let c=t.trim().split("/");if(c.length<3)return NaN;t=c.reverse().join("-")}return o&&(o=o.trim()),Date.parse(`${t}T${o||"00:00"}`)}isInputDateValid(e){let t=this.inputDateToTimeStamp(e);return!Number.isNaN(t)}parseInputDate(e){if(!this.isInputDateValid(e))return"";let t=this.inputDateToTimeStamp(e);return new Date(t).toISOString()}dateValidator(e){let t=e.value;return this.isInputDateValid(t)?null:{invalidDate:!0}}onEdit(){this.isEditing.set(!0)}onSave(){if(this.form.invalid){this.showErrors.set(!0);return}if(!this.rideId)return;let e={};typeof this.arrival=="string"&&(e.arrival=this.parseInputDate(this.form.controls.arrival.value)),typeof this.departure=="string"&&(e.departure=this.parseInputDate(this.form.controls.departure.value)),this.isSaving.set(!0),this.scheduleService.changeTime(this.rideId,this.segmentId,e).subscribe(()=>{this.isEditing.set(!1),this.isSaving.set(!1)})}};r.\u0275fac=function(t){return new(t||r)(w(xe),w(F))},r.\u0275cmp=V({type:r,selectors:[["app-time"]],inputs:{segmentId:"segmentId",rideId:"rideId",arrival:"arrival",departure:"departure",createMode:"createMode",showValidationErrors:"showValidationErrors"},outputs:{timeChange:"timeChange"},standalone:!0,features:[k,T],decls:4,vars:4,consts:[[3,"formGroup"],[1,"row"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","arrival",1,"input",3,"class"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","arrival",1,"input"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","departure",1,"input",3,"class"],["type","text","placeholder","dd/mm/yyyy, hh:mm","formControlName","departure",1,"input"],["mat-button","",3,"disabled"],["mat-button",""],["diameter","35",1,"spinner"],["mat-button","",3,"click"],["color","primary",1,"icon"]],template:function(t,o){t&1&&(a(0,"form",0),g(1,je,5,1,"p",1)(2,Le,5,1,"p",1),s(),g(3,qe,3,1)),t&2&&(v("formGroup",o.form),l(),u(o.arrival!==void 0?1:-1),l(),u(o.departure!==void 0?2:-1),l(),u(o.createMode?-1:3))},dependencies:[X,K,H,W,J,Q,U,le,D,P,O],styles:["[_nghost-%COMP%]{display:flex;justify-content:space-between}.row[_ngcontent-%COMP%]{margin:0}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;font-size:24px!important;margin:0!important}.input[_ngcontent-%COMP%]{min-width:60px;border:1px solid #c4c6d0;outline-color:#c4c6d0}.input-error[_ngcontent-%COMP%]{border-color:#ba1a1a;outline-color:#ba1a1a}"],changeDetection:0});let i=r;return i})();function He(i,r){i&1&&(a(0,"h6",1),m(1,"New Ride"),s())}function We(i,r){if(i&1&&(a(0,"h6",1),m(1),s()),i&2){let n=d();l(),R("Ride ",n.ride==null?null:n.ride.rideId,"")}}function Je(i,r){i&1&&(a(0,"button",2),E(1,"mat-spinner",6),s()),i&2&&v("disabled",!0)}function Ke(i,r){if(i&1){let n=f();a(0,"button",7),C("click",function(){h(n);let t=d();return _(t.onSave())}),a(1,"mat-icon",8),m(2,"save"),s()()}}function Qe(i,r){if(i&1){let n=f();a(0,"button",7),C("click",function(){h(n);let t=d();return _(t.onDelete())}),a(1,"mat-icon",8),m(2,"delete"),s()()}}function Ue(i,r){if(i&1){let n=f();a(0,"app-time",16),C("timeChange",function(t){h(n);let o=d(2);return _(o.onTimeChange(t))}),s()}if(i&2){let n=d().$index,e=d();v("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("departure",e.ride?e.ride.segments[0].time[0]:"")("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function Xe(i,r){if(i&1){let n=f();a(0,"app-time",17),C("timeChange",function(t){h(n);let o=d(2);return _(o.onTimeChange(t))}),s()}if(i&2){let n=d().$index,e=d();v("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("arrival",e.ride?e.ride.segments[n-1].time[1]:"")("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function Ze(i,r){if(i&1){let n=f();a(0,"app-time",18),C("timeChange",function(t){h(n);let o=d(2);return _(o.onTimeChange(t))}),s()}if(i&2){let n=d().$index,e=d();v("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("arrival",e.ride?e.ride.segments[n-1].time[1]:"")("departure",e.ride?e.ride.segments[n].time[0]:"")("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function et(i,r){if(i&1){let n=f();a(0,"app-prices",19),C("pricesChange",function(t){h(n);let o=d(2);return _(o.onPricesChange(t))}),s()}if(i&2){let n=d().$index,e=d();v("rideId",e.ride==null?null:e.ride.rideId)("segmentId",n)("prices",e.ride?e.ride.segments[n].price:e.emptyPrices)("createMode",e.createMode)("showValidationErrors",e.showValidationErrors())}}function tt(i,r){if(i&1&&(a(0,"div",5)(1,"div",9)(2,"strong"),m(3),s()(),a(4,"div",10),g(5,Ue,1,5,"app-time",11)(6,Xe,1,5,"app-time",12)(7,Ze,1,6,"app-time",13),s(),a(8,"div",14),g(9,et,1,5,"app-prices",15),s()()),i&2){let n=r.$implicit,e=r.$index,t=r.$count;l(3),G(n),l(2),u(e===0?5:e===t-1?6:7),l(4),u(e!==t-1?9:-1)}}var Me=(()=>{let r=class r{constructor(e,t){this.scheduleService=e,this.dialog=t,this.closeCard=new N,this.isDeletable=p(!1),this.isSaving=p(!1),this.showValidationErrors=p(!1),this.emptyPrices={},this.newCardPrices=p({}),this.newCardTime=p({}),this.isNewCardValid=M(()=>{let o=this.newCardPrices(),c=this.newCardTime();return!(Object.keys(o).length<this.cities.length-1||Object.keys(c).length<this.cities.length-1||!Object.values(c).every(S=>S.arrival&&S.departure))}),this.newCard=M(()=>{if(!this.isNewCardValid())return[];let o=this.newCardPrices(),c=this.newCardTime();return this.cities.slice(0,-1).map((S,I)=>({time:[c[I].departure,c[I].arrival],price:o[I]}))})}ngOnChanges(e){if("ride"in e){let o=e.ride.currentValue.segments[0].time[0];Date.parse(o)>Date.now()&&this.isDeletable.set(!0)}if("carriages"in e){let t=e.carriages.currentValue;this.emptyPrices=Object.fromEntries(t.map(o=>[o,null]))}}onPricesChange(e){this.newCardPrices.update(t=>y(b({},t),{[e.segmentId]:e.prices}))}onTimeChange(e){this.newCardTime.update(t=>{let{segmentId:o}=e,c=b({},t);return e.time.arrival&&(c[o-1]=y(b({},c[o-1]),{arrival:e.time.arrival})),e.time.departure&&(c[o]=y(b({},c[o]),{departure:e.time.departure})),c})}onDelete(){let e=this.ride?.rideId;e&&this.dialog.open(we,{data:{heading:"Delete ride",content:"Would you like to delete this ride?",onDelete:()=>this.scheduleService.deleteRide(e)},width:"250px",enterAnimationDuration:0,exitAnimationDuration:0})}onSave(){if(!this.isNewCardValid()){this.showValidationErrors.set(!0);return}this.isSaving.set(!0),this.scheduleService.createRide(this.newCard()).subscribe(()=>{this.isSaving.set(!1),this.closeCard.emit()})}};r.\u0275fac=function(t){return new(t||r)(w(F),w(Se))},r.\u0275cmp=V({type:r,selectors:[["app-ride-card"]],inputs:{cities:"cities",carriages:"carriages",ride:"ride",createMode:"createMode"},outputs:{closeCard:"closeCard"},standalone:!0,features:[k,T],decls:9,vars:3,consts:[[1,"header"],[1,"heading"],["mat-button","",3,"disabled"],["mat-button",""],[1,"card-table"],[1,"card-row"],["diameter","35",1,"spinner"],["mat-button","",3,"click"],["color","primary",1,"icon"],[1,"city"],[1,"time"],[3,"rideId","segmentId","departure","createMode","showValidationErrors"],[3,"rideId","segmentId","arrival","createMode","showValidationErrors"],[3,"rideId","segmentId","arrival","departure","createMode","showValidationErrors"],[1,"prices"],[3,"rideId","segmentId","prices","createMode","showValidationErrors"],[3,"timeChange","rideId","segmentId","departure","createMode","showValidationErrors"],[3,"timeChange","rideId","segmentId","arrival","createMode","showValidationErrors"],[3,"timeChange","rideId","segmentId","arrival","departure","createMode","showValidationErrors"],[3,"pricesChange","rideId","segmentId","prices","createMode","showValidationErrors"]],template:function(t,o){t&1&&(a(0,"div",0),g(1,He,2,0,"h6",1)(2,We,2,1,"h6",1)(3,Je,2,1,"button",2)(4,Ke,3,0,"button",3)(5,Qe,3,0,"button",3),s(),a(6,"div",4),$(7,tt,10,3,"div",5,q),s()),t&2&&(l(),u(o.createMode?1:2),l(2),u(o.createMode&&o.isSaving()?3:o.createMode?4:-1),l(2),u(o.isDeletable()?5:-1),l(2),j(o.cities))},dependencies:[be,Ie,D,P,O],styles:['[_nghost-%COMP%]{width:100%;padding-bottom:16px;border:1px solid #c4c6d0;border-radius:12px}.header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 16px;border-bottom:1px solid #c4c6d0}.heading[_ngcontent-%COMP%]{margin-bottom:0}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;font-size:24px!important;margin:0!important}.card-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 1fr;grid-template-areas:"city time ." "city . prices"}.city[_ngcontent-%COMP%]{grid-area:city;min-width:70px;padding:16px;background-color:#fdfbff}.time[_ngcontent-%COMP%]{grid-area:time;padding:16px}.prices[_ngcontent-%COMP%]{grid-area:prices;justify-self:end;min-width:0;padding:16px}'],changeDetection:0});let i=r;return i})();var it=(i,r)=>r.rideId;function nt(i,r){i&1&&E(0,"mat-spinner",1)}function rt(i,r){i&1&&(a(0,"p"),m(1,"Route not found"),s())}function ot(i,r){if(i&1){let n=f();a(0,"button",10),C("click",function(){h(n);let t=d(2);return _(t.onToggleCreate())}),m(1,"Create Ride"),s()}}function at(i,r){if(i&1){let n=f();a(0,"button",11),C("click",function(){h(n);let t=d(2);return _(t.onToggleCreate())}),m(1,"Cancel"),s()}}function st(i,r){if(i&1){let n=f();a(0,"app-ride-card",12),C("closeCard",function(){h(n);let t=d(2);return _(t.onToggleCreate())}),s()}if(i&2){let n=d(2);v("createMode",!0)("cities",n.cities())("carriages",n.carriages())}}function dt(i,r){if(i&1&&E(0,"app-ride-card",9),i&2){let n=r.$implicit,e=d(2);v("ride",n)("cities",e.cities())("carriages",e.carriages())}}function ct(i,r){if(i&1){let n=f();a(0,"div",2)(1,"button",3),C("click",function(){h(n);let t=d();return _(t.onGoBack())}),a(2,"mat-icon",4),m(3,"arrow_back"),s()(),a(4,"h4",5),m(5),s()(),g(6,ot,2,0,"button",6)(7,at,2,0,"button",7)(8,st,1,3,"app-ride-card",8),$(9,dt,1,3,"app-ride-card",9,it)}if(i&2){let n,e=d();l(5),R("Route: ",e.routeId,""),l(),u(e.showCreateCard()?7:6),l(2),u(e.showCreateCard()?8:-1),l(),j((n=e.scheduleService.schedule())==null?null:n.schedule)}}var di=(()=>{let r=class r{constructor(e,t,o,c){this.scheduleService=e,this.router=t,this.location=o,this.activatedRoute=c,this.routeId=this.activatedRoute.snapshot.params.id,this.fromRoutesPage=this.router.getCurrentNavigation()?.extras.state?.fromRoutesPage,this.cities=M(()=>{let S=this.scheduleService.schedule();return S?S.cities:[]}),this.carriages=M(()=>{let S=this.scheduleService.schedule();return S?Array.from(new Set(S.carriages)):[]}),this.showCreateCard=p(!1)}ngOnInit(){this.scheduleService.loadSchedule(this.routeId)}onGoBack(){this.fromRoutesPage?this.location.back():this.router.navigate([".."],{relativeTo:this.activatedRoute})}onToggleCreate(){this.showCreateCard.update(e=>!e)}};r.\u0275fac=function(t){return new(t||r)(w(F),w(ue),w(ce),w(pe))},r.\u0275cmp=V({type:r,selectors:[["app-schedule-page"]],standalone:!0,features:[T],decls:4,vars:1,consts:[[1,"wrapper"],[1,"spinner"],[1,"header"],["mat-button","",3,"click"],[1,"icon"],[1,"heading"],["mat-flat-button","",1,"create-button"],["mat-button","",1,"create-button"],[3,"createMode","cities","carriages"],[3,"ride","cities","carriages"],["mat-flat-button","",1,"create-button",3,"click"],["mat-button","",1,"create-button",3,"click"],[3,"closeCard","createMode","cities","carriages"]],template:function(t,o){t&1&&(a(0,"main",0),g(1,nt,1,0,"mat-spinner",1)(2,rt,2,0,"p")(3,ct,11,3),s()),t&2&&(l(),u(o.scheduleService.isLoading()?1:o.scheduleService.schedule()?o.scheduleService.schedule()?3:-1:2))},dependencies:[Me,D,P,ve,O],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;width:90%;max-width:1300px;margin:20px auto;padding-bottom:24px}.spinner[_ngcontent-%COMP%]{margin:50px}.header[_ngcontent-%COMP%]{display:flex;align-items:center;align-self:flex-start}.heading[_ngcontent-%COMP%]{margin-bottom:0}.icon[_ngcontent-%COMP%]{width:24px!important;height:24px!important;margin:0!important;font-size:24px!important;color:#ccc}.create-button[_ngcontent-%COMP%]{align-self:flex-start}"],changeDetection:0});let i=r;return i})();export{di as SchedulePageComponent};
