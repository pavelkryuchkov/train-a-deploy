import{h as f}from"./chunk-NKAKMUPO.js";import{$ as c,I as n,Y as d,ca as l,ha as p,hb as h,kc as g,mc as I,s,w as a}from"./chunk-SQV3AFQF.js";var y=/^[\w\d_]+@[\w\d_]+\.\w{2,7}$/,k="manager",v=function(r){return r.invalidUniqueKey="invalidUniqueKey",r}(v||{});var E=(()=>{let t=class t{constructor(i){this.http=i}loadUser(){return this.http.get("/api/profile")}editName(i){return this.http.put("/api/profile",{name:i})}editEmail(i){return this.http.put("/api/profile",{email:i}).pipe(a(e=>({profile:e})),n(e=>s({error:e})))}updatePassword(i){return this.http.put("/api/profile/password",{password:i})}};t.\u0275fac=function(e){return new(e||t)(p(f))},t.\u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var m="token",b=(()=>{let t=class t{constructor(i,e){this.http=i,this.profileService=e,this.token=h(null),this.isAdmin=h(!1),this.isLoggedIn=g(()=>!!this.token());let o=localStorage.getItem(m);o&&this.token.set(o),I(()=>{let u=this.token();u?localStorage.setItem(m,u):localStorage.removeItem(m)})}login(i,e){return this.http.post("/api/signin",{email:i,password:e}).pipe(c(o=>{this.token.set(o.token)}),d(()=>this.profileService.loadUser()),c(o=>{o.role===k&&this.isAdmin.set(!0)}),a(o=>({user:o})),n(o=>s({error:o})))}logout(){return this.http.delete("/api/logout").pipe(c(()=>{this.token.set(null),this.isAdmin.set(!1)}))}signUp(i,e){return this.http.post("/api/signup",{email:i,password:e}).pipe(n(o=>s({error:o})))}};t.\u0275fac=function(e){return new(e||t)(p(f),p(E))},t.\u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();export{y as a,k as b,v as c,E as d,b as e};
