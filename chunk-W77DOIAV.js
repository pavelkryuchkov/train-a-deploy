import{a as f}from"./chunk-YAV3XNEK.js";import{a as S}from"./chunk-YP3E4DFS.js";import{b as m}from"./chunk-Y5E3HJHA.js";import{$ as o,Cc as u,a as g,b as d,ca as h,fa as l,ka as n,ob as p}from"./chunk-G6VS4OII.js";var I=(()=>{let s=class s{constructor(t,i,e){this.http=t,this.stationsService=i,this.carriagesService=e,this.baseRoutes=p([]),this.carriages=this.carriagesService.carriages,this.carriagesMap=this.carriagesService.carriagesMap,this.stations=this.stationsService.stations,this.stationsMap=this.stationsService.stationsMap,this.routes=u(()=>this.baseRoutes().map(a=>d(g({},a),{cities:a.path.map(r=>this.stationsMap()[r]?.city||""),carriageNames:a.carriages.map(r=>this.carriagesMap()[r]?.name||r)}))),this.isLoadingRoutes=p(!1),this.isLoadingStations=p(!1),this.isLoading=u(()=>this.isLoadingRoutes()||this.isLoadingStations()),this.loadData()}loadData(){this.loadRoutes(),this.loadStations(),this.loadCarriages()}loadRoutes(){this.isLoadingRoutes.set(!0),this.http.get("/api/route").subscribe(t=>{this.baseRoutes.set(t),this.isLoadingRoutes.set(!1)})}loadStations(){this.isLoadingStations.set(!0),this.stationsService.getStations().subscribe(()=>{this.isLoadingStations.set(!1)})}loadCarriages(){this.carriagesService.getCarriages().subscribe()}deleteRoute(t){return this.http.delete(`/api/route/${t}`).pipe(o(()=>this.http.get("/api/route")),h(i=>this.baseRoutes.set(i)))}createRoute(t,i){return this.http.post("/api/route",{path:t,carriages:i}).pipe(o(()=>this.http.get("/api/route")),h(e=>this.baseRoutes.set(e)))}updateRoute(t,i,e){return this.http.put(`/api/route/${t}`,{path:i,carriages:e}).pipe(o(()=>this.http.get("/api/route")),h(a=>this.baseRoutes.set(a)))}};s.\u0275fac=function(i){return new(i||s)(n(m),n(S),n(f))},s.\u0275prov=l({token:s,factory:s.\u0275fac,providedIn:"root"});let c=s;return c})();export{I as a};
